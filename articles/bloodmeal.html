<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blood feeding • ramp.dts</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Blood feeding">
<meta property="og:description" content="ramp.dts">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramp.dts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Understanding_ramp_dts.html">Understanding ramp.dts</a>
    </li>
    <li>
      <a href="../articles/Contributing.html">Contributing</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Concepts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/heterogeneous_transmission.html">Heterogeneous Transmission</a>
    </li>
    <li>
      <a href="../articles/heterogeneous_biting.html">Heterogeneous Biting</a>
    </li>
    <li>
      <a href="../articles/heterogeneous_mixing.html">Heterogeneous Mixing</a>
    </li>
    <li>
      <a href="../articles/environmental_heterogeneity.html">Environmental Heterogeneity</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Adult Mosquito Dynamics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adult_RM.html">Ross-Macdonald model</a>
    </li>
    <li>
      <a href="../articles/adult_GeRM.html">Generalized Ross-Macdonald model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Aquatic Mosquito Dynamics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aqua_trace.html">Trace (forced) model</a>
    </li>
    <li>
      <a href="../articles/aqua_basic.html">Basic competition model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Human Infection Dynamics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/human_sis.html">SIS model</a>
    </li>
    <li>
      <a href="../articles/human_sip.html">SIP model</a>
    </li>
    <li>
      <a href="../articles/human_hmoi.html">MoI hybrid model</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dd-harp/ramp.dts/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Blood feeding</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/ramp.dts/blob/HEAD/vignettes/bloodmeal.Rmd" class="external-link"><code>vignettes/bloodmeal.Rmd</code></a></small>
      <div class="hidden name"><code>bloodmeal.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Blood feeding (when a adult female mosquito seeks out and feeds on a
blood host) is a crucial <em>invariant</em> in
<strong>Micro-MoB</strong>, and models of mosquito-borne pathogen
transmission (MBPT) generally. Blood feeding is an algorithm which uses
information provided by the interface from each component to compute
values which give the distribution of bites from mosquitoes onto hosts,
and the rate that mosquitoes feed. The blood feeding function
(<code>compute_bloodmeal()</code>) is in <code>R/bloodmeal.R</code>.</p>
</div>
<div class="section level2">
<h2 id="schematic">Schematic<a class="anchor" aria-label="anchor" href="#schematic"></a>
</h2>
<p>Below is a schematic describing visually the quantities that are
generated in the blood meal algorithm. Different colors refer to
different components: green indicates values from the human component,
blue indicates values from the adult mosquito component, and yellow
indicates values from the other blood hosts and visitor components.</p>
<p>Values which are computed by the blood meal which are not directly
involved with transmission are in red, and values that are directly
relevant for transmission are in grey.</p>
<p>The bloodmeal function updates several values within specific
components. Those are:</p>
<ul>
<li>
<span class="math inline">\(\kappa\)</span>: a vector of length
<code>p</code>, giving the net infectiousness of hosts to mosquitoes in
each patch (adult mosquito component).</li>
<li>
<span class="math inline">\(EIR\)</span>: a vector of length
<code>n</code>, giving the entomological inoculation rate on hosts in
each strata (human component).</li>
<li>
<span class="math inline">\(f\)</span>: a vector of length
<code>p</code>, giving the blood feeding rate of mosquitoes in each
patch (adult mosquito component).</li>
<li>
<span class="math inline">\(q\)</span>: a vector of length
<code>p</code>, giving the proportion of blood meals taken on human
hosts by mosquitoes in each patch (adult mosquito component).</li>
</ul>
<p>After these values have been computed, each component’s update (step)
function can use them to update infection in the population. These four
values are the crucial metrics that describe how mosquitoes feed upon
hosts, and how pathogens are transferred between infectious hosts to
susceptible mosquitoes, and vice versa. For this reason we call
bloodfeeding an invariant component, meaning any full MBPT model will
need to simulate this process.</p>
</div>
<div class="section level2">
<h2 id="human-component">Human component<a class="anchor" aria-label="anchor" href="#human-component"></a>
</h2>
<p>Using the generic interface from the human component, the following
values are calculated which are used to compute biting and
transmission.</p>
<ul>
<li>
<code>H</code>: from <code>compute_H</code>, gives the total
population in each strata</li>
<li>
<code>x</code>: from <code>compute_x</code>, gives the net
infectiousness from humans in each strata</li>
<li>
<code>wf</code>: from <code>compute_wf</code>, gives the biting
weights of each strata</li>
<li>
<code>Psi</code>: from <code>compute_Psi</code>, gives the time at
risk matrix</li>
<li>
<code>W</code>: gives the weighted person time at risk spent at each
patch; please note <code>W</code> is calculated from the above values
(rather than from a dispatching method)</li>
</ul>
</div>
<div class="section level2">
<h2 id="mosquito-component">Mosquito component<a class="anchor" aria-label="anchor" href="#mosquito-component"></a>
</h2>
<p>Likewise, the following values are required from the mosquitoes.</p>
<ul>
<li>
<code>f</code>: from <code>compute_f</code>, gives the per-capita
blood feeding rate in each patch</li>
<li>
<code>q</code>: from <code>compute_q</code>, gives the human blood
feeding proportion in each patch</li>
<li>
<code>Z</code>: from <code>compute_Z</code>, gives the infectious
mosquito density in each patch</li>
</ul>
</div>
<div class="section level2">
<h2 id="other-components">Other components<a class="anchor" aria-label="anchor" href="#other-components"></a>
</h2>
<p>We also need to compute:</p>
<ul>
<li>
<code>Wd</code>: from <code>compute_Wd</code>, the biting
availability of visitors in each patch</li>
<li>
<code>O</code>: from <code>compute_O</code>, the biting availability
of other blood hosts in each patch</li>
<li>
<code>xd</code>: from <code>compute_xd</code>, the net
infectiousness of visitors in each patch</li>
</ul>
</div>
<div class="section level2">
<h2 id="biting-distribution-matrix-beta">Biting distribution matrix (<span class="math inline">\(\beta\)</span>)<a class="anchor" aria-label="anchor" href="#biting-distribution-matrix-beta"></a>
</h2>
<p><span class="math inline">\(\beta\)</span>, the biting distribution
matrix, is an <code>n</code> by <code>p</code> matrix which describes
how bites from mosquitoes in patches get distributed over human
population strata. If it is multiplied on the right by a vector <span class="math inline">\(fq \upsilon Z\)</span> which gives the total
number of bites on humans taken by mosquitoes in each patch, the result
is a length <code>n</code> vector giving the per-capita <span class="math inline">\(EIR\)</span>.</p>
<p><span class="math display">\[\begin{equation}
\beta_{n\times p} = \mbox{diag}(w_{f}) \cdot \Psi \cdot \mbox{diag}(1/W)
\\
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="entomological-inoculation-rate-eir">Entomological inoculation rate (<span class="math inline">\(EIR\)</span>)<a class="anchor" aria-label="anchor" href="#entomological-inoculation-rate-eir"></a>
</h2>
<p>The entomological inoculation rate is directly proportional to the
force of infection in humans <span class="math inline">\(h = EIR \cdot
b\)</span>, where <span class="math inline">\(b\)</span> is the
transmission efficiency, the probability a bite from an infectious
mosquito successfully causes infection in a human host. It is simply
computed as:</p>
<p><span class="math display">\[\begin{equation}
EIR_{n\times 1} = \beta \cdot fq\upsilon Z
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="net-infectiousness-of-the-human-population-kappa">Net infectiousness of the human population (<span class="math inline">\(\kappa\)</span>)<a class="anchor" aria-label="anchor" href="#net-infectiousness-of-the-human-population-kappa"></a>
</h2>
<p>The net infectiousness of humans is the probability that a mosquito
would become infected after biting a random human host. It’s directly
proportional the force of infection in mosquitoes, which is <span class="math inline">\(\kappa fq\)</span>. After being calculated and
passed to the mosquitoes, any particular mosquito model can use it to
update state over a time step.</p>
<p><span class="math display">\[\begin{equation}
\kappa_{p\times 1} = \upsilon \cdot (\beta^{\top} \cdot xH) + (1 -
\upsilon) x_{\delta}
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="directed-wiring-diagram">Directed wiring diagram<a class="anchor" aria-label="anchor" href="#directed-wiring-diagram"></a>
</h2>
<p>Another way to view the bloodmeal computation is as a <a href="https://www.algebraicjulia.org/blog/post/2021/01/machines/" class="external-link">directed
wiring diagram (DWD)</a>. In this DWD there are two types of “boxes”,
rectangles and circles. Rectangles are elements of the model with state,
similar to machines in automata theory. Circles represent functions
which do not have internal state, but may take some number of inputs and
produce and output. Circles which are inside of a rectangle represent
functions that “belong” to that rectangle.</p>
<p>Putting this back in terms of <strong>Micro-MoB</strong>, rectangles
are components and circles are either <em>invariant</em> functions (if
they live outside of a box), or are methods that dispatch depending on
what model fills their component (if they live inside of a box).</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
