<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MicroMoB">
<title>Beverton-Holt aquatic model • MicroMoB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Beverton-Holt aquatic model">
<meta property="og:description" content="MicroMoB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MicroMoB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/MicroMoB.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BH_aqua.html">Beverton-Holt aquatic model</a>
    <a class="dropdown-item" href="../articles/Contributing.html">Contributing</a>
    <a class="dropdown-item" href="../articles/MOI_human.html">Queueing model for human superinfection</a>
    <a class="dropdown-item" href="../articles/RM_mosquito.html">Ross-Macdonald mosquito model</a>
    <a class="dropdown-item" href="../articles/RM_transmission.html">Ross-Macdonald transmission model</a>
    <a class="dropdown-item" href="../articles/key-themes.html">key-themes</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/MicroMoB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Beverton-Holt aquatic model</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/MicroMoB/blob/HEAD/vignettes/BH_aqua.Rmd" class="external-link"><code>vignettes/BH_aqua.Rmd</code></a></small>
      <div class="d-none name"><code>BH_aqua.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dd-harp/MicroMoB" class="external-link">MicroMoB</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></code></pre></div>
<p>The simplest non-trivial model of aquatic mosquito dynamics which exhibits density-dependence (negative feedback) is a Beverton-Holt (BH) style model. It is a kind of discrete logistic equation. We have implemented a BH model that conforms to the aquatic (immature) component interface to be used with other mosquito models fulfilling the adult component interface.</p>
<p>The model groups all immature mosquito stages into a single compartment <code>L</code>. Each time step some number may mature and be ready to emerge as adults, <code>A</code>. The model requires 3 (potentially time and patch varying parameters), <code>K</code>, which determines the strength of density dependent mortality, <code>surv</code>, the baseline daily survival probability, and <code>molt</code>, the daily proportion of immature mosquitoes which mature and emerge as adults.</p>
<div class="section level2">
<h2 id="deterministic-model">Deterministic model<a class="anchor" aria-label="anchor" href="#deterministic-model"></a>
</h2>
<p>The state updating equation is as follows:</p>
<p><span class="math display">\[\begin{equation}
L_{t+1} = eggs + (1-molt) \cdot surv \cdot L_{t} \frac{K}{L_{t}+K} \\
A_{t} = molt \cdot surv \cdot L_{t} \frac{K}{L_{t}+K}
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="stochastic-model">Stochastic model<a class="anchor" aria-label="anchor" href="#stochastic-model"></a>
</h2>
<p>In the stochastic model on a time step, we first draw the number of survivors:</p>
<p><span class="math display">\[\begin{equation}
survivors \sim \mathrm{binomial}(L, surv \frac{K}{L_{t}+K})
\end{equation}\]</span></p>
<p>The number who emerge is also a binomial random variate:</p>
<p><span class="math display">\[\begin{equation}
emerge \sim \mathrm{binomial}(survivors, molt)
\end{equation}\]</span></p>
<p>Then state is updated:</p>
<p><span class="math display">\[\begin{equation}
L_{t+1} = eggs + survivors - emerge \\
A_{t} = emerge
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="deterministic-equilbrium">Deterministic equilbrium<a class="anchor" aria-label="anchor" href="#deterministic-equilbrium"></a>
</h2>
<p>Despite being a nonlinear equation, we can solve the equilibrium. We assume that <code>eggs</code> is known, and that the desired daily emergence is known (<code>lambda</code>, or <code>A</code> in the BH model’s notation). Then we solve for <code>K</code> and <code>L</code>:</p>
<p><span class="math display">\[\begin{equation}
L = \lambda \left( \frac{1}{molt} - 1 \right) + eggs \\
K = \frac{-\lambda L}{\lambda - L \cdot molt \cdot surv}
\end{equation}\]</span></p>
<p>We can set up a simulation using the RM mosquito model to check that everything is at equilibrium. First we calculate the equilibrium values. We do not use any components other than the aquatic and adult mosquito components.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">patches</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">tmax</span> <span class="op">&lt;-</span> <span class="fl">1e2</span>

<span class="va">M</span> <span class="op">&lt;-</span> <span class="fl">120</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.9</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">M</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span>

<span class="va">nu</span> <span class="op">&lt;-</span> <span class="fl">25</span>
<span class="va">f</span> <span class="op">&lt;-</span> <span class="fl">0.3</span>
<span class="va">eggs</span> <span class="op">&lt;-</span> <span class="va">nu</span> <span class="op">*</span> <span class="va">f</span> <span class="op">*</span> <span class="va">M</span>

<span class="co"># static pars</span>
<span class="va">molt</span> <span class="op">&lt;-</span>  <span class="fl">0.1</span>
<span class="va">surv</span> <span class="op">&lt;-</span> <span class="fl">0.9</span>

<span class="co"># solve L</span>
<span class="va">L</span> <span class="op">&lt;-</span> <span class="va">lambda</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">molt</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">eggs</span>
<span class="va">K</span> <span class="op">&lt;-</span> <span class="op">-</span> <span class="op">(</span><span class="va">lambda</span> <span class="op">*</span> <span class="va">L</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">lambda</span> <span class="op">-</span> <span class="va">L</span><span class="op">*</span><span class="va">molt</span><span class="op">*</span><span class="va">surv</span><span class="op">)</span></code></pre></div>
<p>Now we run a deterministic simulation and draw 10 stochastic trajectories.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># deterministic run</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_MicroMoB.html">make_MicroMoB</a></span><span class="op">(</span>tmax <span class="op">=</span> <span class="va">tmax</span>, p <span class="op">=</span> <span class="va">patches</span><span class="op">)</span>
<span class="fu"><a href="../reference/setup_aqua_BH.html">setup_aqua_BH</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span>, stochastic <span class="op">=</span> <span class="cn">FALSE</span>, molt <span class="op">=</span> <span class="va">molt</span>, surv <span class="op">=</span> <span class="va">surv</span>, K <span class="op">=</span> <span class="va">K</span>, L <span class="op">=</span> <span class="va">L</span><span class="op">)</span>
<span class="fu"><a href="../reference/setup_mosquito_RM.html">setup_mosquito_RM</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span>, stochastic <span class="op">=</span> <span class="cn">FALSE</span>, f <span class="op">=</span> <span class="va">f</span>, q <span class="op">=</span> <span class="fl">0.9</span>, eip <span class="op">=</span> <span class="fl">10</span>, p <span class="op">=</span> <span class="va">p</span>, psi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, nu <span class="op">=</span> <span class="va">nu</span>, M <span class="op">=</span> <span class="va">M</span>, Y <span class="op">=</span> <span class="fl">0</span>, Z <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="va">out_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NaN</span>, nrow <span class="op">=</span> <span class="va">tmax</span> <span class="op">+</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">out_det</span><span class="op">[</span><span class="fl">1L</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">L</span>, <span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">A</span>, <span class="va">mod</span><span class="op">$</span><span class="va">mosquito</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>

<span class="kw">while</span> <span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">&lt;=</span> <span class="va">tmax</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="../reference/step_aqua.html">step_aqua</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span>
  <span class="fu"><a href="../reference/step_mosquitoes.html">step_mosquitoes</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span>
  <span class="va">out_det</span><span class="op">[</span><span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">+</span> <span class="fl">1L</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">L</span>, <span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">A</span>, <span class="va">mod</span><span class="op">$</span><span class="va">mosquito</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>
  <span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">+</span> <span class="fl">1L</span>
<span class="op">}</span>

<span class="co"># stochastic runs</span>
<span class="va">out_sto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">runid</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_MicroMoB.html">make_MicroMoB</a></span><span class="op">(</span>tmax <span class="op">=</span> <span class="va">tmax</span>, p <span class="op">=</span> <span class="va">patches</span><span class="op">)</span>
  <span class="fu"><a href="../reference/setup_aqua_BH.html">setup_aqua_BH</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span>, stochastic <span class="op">=</span> <span class="cn">TRUE</span>, molt <span class="op">=</span> <span class="va">molt</span>, surv <span class="op">=</span> <span class="va">surv</span>, K <span class="op">=</span> <span class="va">K</span>, L <span class="op">=</span> <span class="va">L</span><span class="op">)</span>
  <span class="fu"><a href="../reference/setup_mosquito_RM.html">setup_mosquito_RM</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span>, stochastic <span class="op">=</span> <span class="cn">TRUE</span>, f <span class="op">=</span> <span class="va">f</span>, q <span class="op">=</span> <span class="fl">0.9</span>, eip <span class="op">=</span> <span class="fl">10</span>, p <span class="op">=</span> <span class="va">p</span>, psi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, nu <span class="op">=</span> <span class="va">nu</span>, M <span class="op">=</span> <span class="va">M</span>, Y <span class="op">=</span> <span class="fl">0</span>, Z <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
  
  <span class="va">out_run</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="cn">NaN</span>, nrow <span class="op">=</span> <span class="va">tmax</span> <span class="op">+</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
  <span class="va">out_run</span><span class="op">[</span><span class="fl">1L</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">L</span>, <span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">A</span>, <span class="va">mod</span><span class="op">$</span><span class="va">mosquito</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>
  
  <span class="kw">while</span> <span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">&lt;=</span> <span class="va">tmax</span><span class="op">)</span> <span class="op">{</span>
    <span class="fu"><a href="../reference/step_aqua.html">step_aqua</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span>
    <span class="fu"><a href="../reference/step_mosquitoes.html">step_mosquitoes</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">mod</span><span class="op">)</span>
    <span class="va">out_run</span><span class="op">[</span><span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">+</span> <span class="fl">1L</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">L</span>, <span class="va">mod</span><span class="op">$</span><span class="va">aqua</span><span class="op">$</span><span class="va">A</span>, <span class="va">mod</span><span class="op">$</span><span class="va">mosquito</span><span class="op">$</span><span class="va">M</span><span class="op">)</span>
    <span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">&lt;-</span> <span class="va">mod</span><span class="op">$</span><span class="va">global</span><span class="op">$</span><span class="va">tnow</span> <span class="op">+</span> <span class="fl">1L</span>
  <span class="op">}</span>
  
  <span class="va">out_run</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">out_run</span><span class="op">)</span>
  <span class="va">out_run</span><span class="op">$</span><span class="va">run</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">runid</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out_run</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>


<span class="va">out_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">out_det</span><span class="op">)</span>
<span class="va">out_det</span><span class="op">[</span>, <span class="st">"Day"</span> <span class="op">:=</span> <span class="fl">0</span><span class="op">:</span><span class="va">tmax</span><span class="op">]</span>
<span class="va">out_det</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">out_det</span>, id.vars <span class="op">=</span> <span class="st">"Day"</span>, variable.name <span class="op">=</span> <span class="st">"Stage"</span>, value.name <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">out_det</span><span class="op">$</span><span class="va">Stage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L"</span>, <span class="st">"A"</span>, <span class="st">"M"</span><span class="op">)</span>

<span class="va">out_sto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">out_sto</span><span class="op">)</span>
<span class="va">out_sto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">out_sto</span><span class="op">)</span>
<span class="va">out_sto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">out_sto</span>, id.vars <span class="op">=</span> <span class="st">"run"</span>, variable.name <span class="op">=</span> <span class="st">"Stage"</span>, value.name <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span>
<span class="va">out_sto</span><span class="op">[</span>, <span class="st">"Day"</span> <span class="op">:=</span> <span class="fl">0</span><span class="op">:</span><span class="va">tmax</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"run"</span>, <span class="st">"Stage"</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">out_sto</span><span class="op">$</span><span class="va">Stage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"L"</span>, <span class="st">"A"</span>, <span class="st">"M"</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">out_sto</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Day</span>, y <span class="op">=</span> <span class="va">Count</span>, color <span class="op">=</span> <span class="va">Stage</span>, group <span class="op">=</span> <span class="va">run</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">out_det</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Day</span>, y <span class="op">=</span> <span class="va">Count</span>, color <span class="op">=</span> <span class="va">Stage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">Stage</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<p><img src="BH_aqua_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
