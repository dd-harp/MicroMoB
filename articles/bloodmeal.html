<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MicroMoB">
<title>Blood feeding • MicroMoB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Blood feeding">
<meta property="og:description" content="MicroMoB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MicroMoB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/MicroMoB.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/bloodmeal.html">Blood feeding</a>
    <a class="dropdown-item" href="../articles/RM_mosquito.html">Ross-Macdonald mosquito model</a>
    <a class="dropdown-item" href="../articles/BQ_mosquito.html">Simple behavioral state mosquito model</a>
    <a class="dropdown-item" href="../articles/MOI_human.html">Queueing model for human superinfection</a>
    <a class="dropdown-item" href="../articles/BH_aqua.html">Beverton-Holt aquatic model</a>
    <a class="dropdown-item" href="../articles/RM_transmission.html">Ross-Macdonald transmission model</a>
    <a class="dropdown-item" href="../articles/Advanced.html">Advanced topics</a>
    <a class="dropdown-item" href="../articles/Contributing.html">Contributing</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/MicroMoB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Blood feeding</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/MicroMoB/blob/HEAD/vignettes/bloodmeal.Rmd" class="external-link"><code>vignettes/bloodmeal.Rmd</code></a></small>
      <div class="d-none name"><code>bloodmeal.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Blood feeding (when a adult female mosquito seeks out and feeds on a
blood host) is a crucial <em>invariant</em> in
<strong>Micro-MoB</strong>, and models of mosquito-borne pathogen
transmission (MBPT) generally. Blood feeding is an algorithm which uses
information provided by the interface from each component to compute
values which give the distribution of bites from mosquitoes onto hosts,
and the rate that mosquitoes feed. The blood feeding function
(<code><a href="../reference/compute_bloodmeal.html">compute_bloodmeal()</a></code>) is in <code>R/bloodmeal.R</code>.</p>
</div>
<div class="section level2">
<h2 id="schematic">Schematic<a class="anchor" aria-label="anchor" href="#schematic"></a>
</h2>
<p>Below is a schematic describing visually the quantities that are
generated in the blood meal algorithm. Different colors refer to
different components: green indicates values from the human component,
blue indicates values from the adult mosquito component, and yellow
indicates values from the other blood hosts and visitor components.</p>
<p>Values which are computed by the blood meal which are not directly
involved with transmission are in red, and values that are directly
relevant for transmission are in grey.</p>
<p><img src="bloodfeeding.png" width="100%"></p>
<p>The bloodmeal function updates several values within specific
components. Those are:</p>
<ul>
<li>
<span class="math inline">\(\kappa\)</span>: a vector of length
<code>p</code>, giving the net infectiousness of hosts to mosquitoes in
each patch (adult mosquito component).</li>
<li>
<span class="math inline">\(EIR\)</span>: a vector of length
<code>n</code>, giving the entomological inoculation rate on hosts in
each strata (human component).</li>
<li>
<span class="math inline">\(f\)</span>: a vector of length
<code>p</code>, giving the blood feeding rate of mosquitoes in each
patch (adult mosquito component).</li>
<li>
<span class="math inline">\(q\)</span>: a vector of length
<code>p</code>, giving the proportion of blood meals taken on human
hosts by mosquitoes in each patch (adult mosquito component).</li>
</ul>
<p>After these values have been computed, each component’s update (step)
function can use them to update infection in the population. These four
values are the crucial metrics that describe how mosquitoes feed upon
hosts, and how pathogens are transferred between infectious hosts to
susceptible mosquitoes, and vice versa. For this reason we call
bloodfeeding an invariant component, meaning any full MBPT model will
need to simulate this process.</p>
</div>
<div class="section level2">
<h2 id="human-component">Human component<a class="anchor" aria-label="anchor" href="#human-component"></a>
</h2>
<p>Using the generic interface from the human component, the following
values are calculated which are used to compute biting and
transmission.</p>
<ul>
<li>
<code>H</code>: from <code>compute_H</code>, gives the total
population in each strata</li>
<li>
<code>x</code>: from <code>compute_x</code>, gives the net
infectiousness from humans in each strata</li>
<li>
<code>wf</code>: from <code>compute_wf</code>, gives the biting
weights of each strata</li>
<li>
<code>Psi</code>: from <code>compute_Psi</code>, gives the time at
risk matrix</li>
<li>
<code>W</code>: gives the weighted person time at risk spent at each
patch; please note <code>W</code> is calculated from the above values
(rather than from a dispatching method)</li>
</ul>
</div>
<div class="section level2">
<h2 id="mosquito-component">Mosquito component<a class="anchor" aria-label="anchor" href="#mosquito-component"></a>
</h2>
<p>Likewise, the following values are required from the mosquitoes.</p>
<ul>
<li>
<code>f</code>: from <code>compute_f</code>, gives the per-capita
blood feeding rate in each patch</li>
<li>
<code>q</code>: from <code>compute_q</code>, gives the human blood
feeding proportion in each patch</li>
<li>
<code>Z</code>: from <code>compute_Z</code>, gives the infectious
mosquito density in each patch</li>
</ul>
</div>
<div class="section level2">
<h2 id="other-components">Other components<a class="anchor" aria-label="anchor" href="#other-components"></a>
</h2>
<p>We also need to compute:</p>
<ul>
<li>
<code>Wd</code>: from <code>compute_Wd</code>, the biting
availability of visitors in each patch</li>
<li>
<code>O</code>: from <code>compute_O</code>, the biting availability
of other blood hosts in each patch</li>
<li>
<code>xd</code>: from <code>compute_xd</code>, the net
infectiousness of visitors in each patch</li>
</ul>
</div>
<div class="section level2">
<h2 id="biting-distribution-matrix-beta">Biting distribution matrix (<span class="math inline">\(\beta\)</span>)<a class="anchor" aria-label="anchor" href="#biting-distribution-matrix-beta"></a>
</h2>
<p><span class="math inline">\(\beta\)</span>, the biting distribution
matrix, is an <code>n</code> by <code>p</code> matrix which describes
how bites from mosquitoes in patches get distributed over human
population strata. If it is multiplied on the right by a vector <span class="math inline">\(fq \upsilon Z\)</span> which gives the total
number of bites on humans taken by mosquitoes in each patch, the result
is a length <code>n</code> vector giving the per-capita <span class="math inline">\(EIR\)</span>.</p>
<p><span class="math display">\[\begin{equation}
\beta_{n\times p} = \mbox{diag}(w_{f}) \cdot \Psi \cdot \mbox{diag}(1/W)
\\
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="entomological-inoculation-rate-eir">Entomological inoculation rate (<span class="math inline">\(EIR\)</span>)<a class="anchor" aria-label="anchor" href="#entomological-inoculation-rate-eir"></a>
</h2>
<p>The entomological inoculation rate is directly proportional to the
force of infection in humans <span class="math inline">\(h = EIR \cdot
b\)</span>, where <span class="math inline">\(b\)</span> is the
transmission efficiency, the probability a bite from an infectious
mosquito successfully causes infection in a human host. It is simply
computed as:</p>
<p><span class="math display">\[\begin{equation}
EIR_{n\times 1} = \beta \cdot fq\upsilon Z
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="net-infectiousness-of-the-human-population-kappa">Net infectiousness of the human population (<span class="math inline">\(\kappa\)</span>)<a class="anchor" aria-label="anchor" href="#net-infectiousness-of-the-human-population-kappa"></a>
</h2>
<p>The net infectiousness of humans is the probability that a mosquito
would become infected after biting a random human host. It’s directly
proportional the force of infection in mosquitoes, which is <span class="math inline">\(\kappa fq\)</span>. After being calculated and
passed to the mosquitoes, any particular mosquito model can use it to
update state over a time step.</p>
<p><span class="math display">\[\begin{equation}
\kappa_{p\times 1} = \upsilon \cdot (\beta^{\top} \cdot xH) + (1 -
\upsilon) x_{\delta}
\end{equation}\]</span></p>
</div>
<div class="section level2">
<h2 id="directed-wiring-diagram">Directed wiring diagram<a class="anchor" aria-label="anchor" href="#directed-wiring-diagram"></a>
</h2>
<p>Another way to view the bloodmeal computation is as a <a href="https://www.algebraicjulia.org/blog/post/2021/01/machines/" class="external-link">directed
wiring diagram (DWD)</a>. In this DWD there are two types of “boxes”,
rectangles and circles. Rectangles are elements of the model with state,
similar to machines in automata theory. Circles represent functions
which do not have internal state, but may take some number of inputs and
produce and output. Circles which are inside of a rectangle represent
functions that “belong” to that rectangle.</p>
<p>Putting this back in terms of <strong>Micro-MoB</strong>, rectangles
are components and circles are either <em>invariant</em> functions (if
they live outside of a box), or are methods that dispatch depending on
what model fills their component (if they live inside of a box).</p>
<p><img src="bloodfeeding_DWD.png" width="100%"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
