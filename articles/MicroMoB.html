<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MicroMoB">
<title>Micro-MoB (Microsimulation for mosquito-borne pathogens) • MicroMoB</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Micro-MoB (Microsimulation for mosquito-borne pathogens)">
<meta property="og:description" content="MicroMoB">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MicroMoB</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/MicroMoB.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/BH_aqua.html">Beverton-Holt aquatic model</a>
    <a class="dropdown-item" href="../articles/Contributing.html">Contributing</a>
    <a class="dropdown-item" href="../articles/MOI_human.html">Queueing model for human superinfection</a>
    <a class="dropdown-item" href="../articles/RM_mosquito.html">Ross-Macdonald mosquito model</a>
    <a class="dropdown-item" href="../articles/RM_transmission.html">Ross-Macdonald transmission model</a>
    <a class="dropdown-item" href="../articles/bloodmeal.html">Blood feeding</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/MicroMoB/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">

<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Micro-MoB (Microsimulation for mosquito-borne pathogens)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/MicroMoB/blob/HEAD/vignettes/MicroMoB.Rmd" class="external-link"><code>vignettes/MicroMoB.Rmd</code></a></small>
      <div class="d-none name"><code>MicroMoB.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>Micro-MoB</strong> is a software package which implements a framework for building mathematical models of mosquito-borne pathogen transmission (MBPT). The framework is flexible enough to model real scenarios while at the same time places constraints upon how parts of the framework interact so that the software does not become obfuscatingly complex each time a new feature must be added.</p>
<p>The framework defines <strong>components</strong> which have an <strong>interface</strong>. The components cover all parts of MBPT models: adult mosquitoes, immature (aquatic) mosquitoes, resident humans, non-resident visitors, and other blood hosts. A specific instantation of a component is called a <strong>model</strong>. For example, the Ross-Macdonald model of adult mosquito dynamics can fulfill the adult mosquito interface and thus fill that component “box”. Certain computations that involve the passing of information between components are <strong>invariant</strong>, such as the bloodmeal, where a matrix is computed describing how bites from mosquitoes are distributed across hosts. These computations use the generic component interface, so any model fulfilling an interface can fit seamlessly into the existing set of models.</p>
<div class="section level3">
<h3 id="software-design">Software design<a class="anchor" aria-label="anchor" href="#software-design"></a>
</h3>
<p>To accomplish this component-interface design in R, we use the <a href="http://adv-r.had.co.nz/S3.html" class="external-link">S3 object system</a>. Each component is a named element in the model object (an environment). The interface defines a set of generic functions which dispatch on the specific class of the object taking the place of that component.</p>
</div>
<div class="section level3">
<h3 id="dynamics">Dynamics<a class="anchor" aria-label="anchor" href="#dynamics"></a>
</h3>
<p>A simplified conceptual overview of dynamics in <strong>Micro-MoB</strong> is shown below. Over a time step, aquatic (immature) mosquitoes take in eggs laid by ovipositing adult mosquitoes <span class="math inline">\(G\)</span>, and give rise to newly emerging adults <span class="math inline">\(\Lambda\)</span>. Adult mosquitoes undergo mortality and search for blood meals. The proportion of bites on human hosts which cause infections in mosquitoes is <span class="math inline">\(\kappa\)</span>, and causes some fraction of mosquitoes to become infected <span class="math inline">\(Y\)</span> and eventually infectious <span class="math inline">\(Z\)</span>. The human component takes in <span class="math inline">\(EIR\)</span>, the per-capita rate at which persons receive infectious bites, which affects prevalence <span class="math inline">\(X\)</span>.</p>
<p>The red circle represents the <em>bloodmeal</em>, the process by which adult mosquitoes initiate an oviposition cycle, seek out available hosts, and attempt to feed on them. It is this process which transfers pathogens between the two species.</p>
<p><img src="DynamicsOverview.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="components">Components<a class="anchor" aria-label="anchor" href="#components"></a>
</h2>
<p>The model is broken into components, for humans, immature and adult mosquitoes (and some others). Each component has an <em>interface</em>, which are methods which must be defined for that component. A component’s interface is stored in file, for example, <code>R/humans_interface.R</code> shows the user what methods must be defined for any human model. Other components (e.g. the bloodmeal) will call generic methods not knowing what specific code is implementing them, and so they must return values consistent with their definition.</p>
<p>We call a specific implementation of a component a <em>model</em>. Specific implementations are found in files that replace <em>_interface</em> with the model name, for example R/humans_SIR.R. Their accompanying test files are located in tests/testthat. If you are creating a new model, please remember to test it adequately.</p>
<p>We list the components which require interfaces below and specific models to implement them.</p>
<div class="section level3">
<h3 id="mosquitoes">Mosquitoes<a class="anchor" aria-label="anchor" href="#mosquitoes"></a>
</h3>
<p>The mosquito component is responsible for all dynamics which update adult mosquito populations. The interface is defined in <code>R/mosquito_interface.R</code>, and the interface methods which are required to be implemented can be found <a href="https://dd-harp.github.io/MicroMoB/reference/index.html#adult-mosquito-component">here</a>.</p>
</div>
<div class="section level3">
<h3 id="aquatic">Aquatic<a class="anchor" aria-label="anchor" href="#aquatic"></a>
</h3>
<p>The aquatic component is responsible for all dynamics which update immature (aquatic stage) mosquito populations. The interface is defined in <code>R/aquatic_interface.R</code>, and the interface methods with are required to be implemented can be found <a href="https://dd-harp.github.io/MicroMoB/reference/index.html#aquatic-immature-mosquito-component">here</a>.</p>
</div>
<div class="section level3">
<h3 id="humans">Humans<a class="anchor" aria-label="anchor" href="#humans"></a>
</h3>
<p>The human component updates human populations. The interface is defined in <code>R/humans_interface.R</code>, and the interface methods with are required to be implemented can be found <a href="https://dd-harp.github.io/MicroMoB/reference/index.html#human-component">here</a>.</p>
</div>
<div class="section level3">
<h3 id="visitor">Visitor<a class="anchor" aria-label="anchor" href="#visitor"></a>
</h3>
<p>The human component updates human populations outside of the resident population of the geographic area being simulated. The interface is defined in <code>R/visitor_interface.R</code>, and the interface methods with are required to be implemented can be found <a href="https://dd-harp.github.io/MicroMoB/reference/index.html#visitor-component">here</a>.</p>
</div>
<div class="section level3">
<h3 id="other-blood-hosts">Other blood hosts<a class="anchor" aria-label="anchor" href="#other-blood-hosts"></a>
</h3>
<p>The other (alternative) blood host component is responsible for other blood hosts for mosquitoes (livestock, dogs, etc). The interface is defined in <code>R/other_interface.R</code>, and the interface methods with are required to be implemented can be found <a href="https://dd-harp.github.io/MicroMoB/reference/index.html#alternative-blood-hosts-component">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="writing-new-models">Writing new models<a class="anchor" aria-label="anchor" href="#writing-new-models"></a>
</h2>
<p>To write a model for a component means that one must write methods that fulfill each component’s interface, and ensure that those methods return the correct data structure. Information on the methods can be found in the function reference under each component. In addition, a new model must have a setup function, which takes in parameters, does argument checking, and attaches a new object with the correct name and class attached to the model object returned from <code><a href="../reference/make_MicroMoB.html">make_MicroMoB()</a></code>.</p>
<p>For example, to make a new mosquito model, with class <code>MyModel</code>, one would need to do the following:</p>
<ol style="list-style-type: decimal">
<li>Write a function <code>setup_mosquito_MyModel</code> which attaches an object (usually a list) to the model environment with the <code>class</code> attribute assigned to <code>"MyModel"</code>.</li>
<li>Write methods for the interface <code>compute_f.MyModel</code>, <code>compute_q.MyModel</code>, <code>compute_Z.MyModel</code>, and <code>compute_oviposit.MyModel</code>. Information on what each method is expected to compute and return can be found <a href="https://dd-harp.github.io/MicroMoB/reference/index.html#adult-mosquito-component">here</a>.</li>
<li>Write a step (updating) function, <code>step_mosquitoes.MyModel</code>. One can optionally allow the <code>class</code> attribute of the model list to have 2 elements to allow for dispatching on stochastic or deterministic step updates, in which case one would additionally write <code>step_mosquitoes.MyModel_stochastic</code> and <code>step_mosquitoes.MyModel_deterministic</code>. Please look at the <a href="https://github.com/dd-harp/MicroMoB/blob/HEAD/R/mosquito_RM.R" class="external-link">source code</a> of the Ross-Macdonald mosquito model to see how to do this.</li>
</ol>
</div>
<div class="section level2">
<h2 id="invariants">Invariants<a class="anchor" aria-label="anchor" href="#invariants"></a>
</h2>
<p>What we call <em>invariants</em> are functions which do not dispatch on any types; rather they collect the information they need from each component via that component’s interface, which will return information in the right dimension for any properly written model fulfilling that component. These invariants use that information to compute quantities that allow interaction (feedback) between components, which is passed back to each component and used to compute their update.</p>
<div class="section level3">
<h3 id="bloodmeal">Bloodmeal<a class="anchor" aria-label="anchor" href="#bloodmeal"></a>
</h3>
<p>We describe how the bloodmeal algorithm works in a separate article, <code><a href="../articles/bloodmeal.html">vignette("bloodmeal")</a></code>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
